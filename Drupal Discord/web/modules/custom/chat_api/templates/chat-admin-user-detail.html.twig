{#
/**
 * @file
 * Template for Chat Admin User Detail Page.
 *
 * Available variables:
 * - user_info: User basic information (uid, name, email, created, access, status, roles)
 * - stats: User statistics (friends_count, pending_sent, pending_received, days_registered)
 * - friends: List of user's friends
 * - pending_sent: Friend requests sent by user
 * - pending_received: Friend requests received by user
 * - recent_activity: User's recent activity log
 */
#}

<div class="chat-admin-user-detail">
  {# Page Header #}
  <div class="page-header">
    <div class="header-left">
      <a href="/admin/chat/users" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Back to Users
      </a>
      <h1>
        <i class="fas fa-user-circle"></i>
        {{ user_info.name }}
      </h1>
    </div>
    <div class="header-actions">
      <a href="/user/{{ user_info.uid }}/edit" class="btn btn-primary">
        <i class="fas fa-edit"></i> Edit User
      </a>
      {% if user_info.status %}
        <button class="btn btn-danger action-block" data-uid="{{ user_info.uid }}">
          <i class="fas fa-ban"></i> Block User
        </button>
      {% else %}
        <button class="btn btn-success action-unblock" data-uid="{{ user_info.uid }}">
          <i class="fas fa-check"></i> Unblock User
        </button>
      {% endif %}
    </div>
  </div>

  {# User Profile Card #}
  <div class="profile-section">
    <div class="profile-card">
      <div class="profile-avatar">
        <div class="avatar-circle">
          {{ user_info.name|first|upper }}
        </div>
      </div>
      <div class="profile-info">
        <h2>{{ user_info.name }}</h2>
        <p class="email"><i class="fas fa-envelope"></i> {{ user_info.email }}</p>
        <div class="profile-badges">
          {% if user_info.status %}
            <span class="badge badge-success"><i class="fas fa-circle"></i> Active</span>
          {% else %}
            <span class="badge badge-danger"><i class="fas fa-ban"></i> Blocked</span>
          {% endif %}
          {% for role in user_info.roles %}
            {% if role != 'authenticated' %}
              <span class="badge badge-info"><i class="fas fa-shield-alt"></i> {{ role|capitalize }}</span>
            {% endif %}
          {% endfor %}
        </div>
        <div class="profile-meta">
          <div class="meta-item">
            <i class="fas fa-calendar-plus"></i>
            <span>Registered: {{ user_info.created|date('M d, Y') }}</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-clock"></i>
            <span>Last access: 
              {% if user_info.access > 0 %}
                {{ user_info.access|date('M d, Y H:i') }}
              {% else %}
                Never
              {% endif %}
            </span>
          </div>
          <div class="meta-item">
            <i class="fas fa-sign-in-alt"></i>
            <span>Last login: 
              {% if user_info.login > 0 %}
                {{ user_info.login|date('M d, Y H:i') }}
              {% else %}
                Never
              {% endif %}
            </span>
          </div>
          <div class="meta-item">
            <i class="fas fa-hourglass-half"></i>
            <span>Member for: {{ stats.days_registered }} days</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  {# Statistics Overview #}
  <div class="stats-section">
    <h2><i class="fas fa-chart-bar"></i> Statistics Overview</h2>
    <div class="stats-grid">
      <div class="stat-box">
        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          <i class="fas fa-user-friends"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.friends_count }}</div>
          <div class="stat-label">Friends</div>
        </div>
      </div>
      
      <div class="stat-box">
        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
          <i class="fas fa-paper-plane"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.pending_sent }}</div>
          <div class="stat-label">Requests Sent</div>
        </div>
      </div>
      
      <div class="stat-box">
        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
          <i class="fas fa-inbox"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.pending_received }}</div>
          <div class="stat-label">Requests Received</div>
        </div>
      </div>
      
      <div class="stat-box">
        <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
          <i class="fas fa-calendar-check"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ stats.days_registered }}</div>
          <div class="stat-label">Days Registered</div>
        </div>
      </div>
    </div>
  </div>

  {# Two Column Layout #}
  <div class="content-grid">
    {# Left Column #}
    <div class="content-left">
      {# Friends List #}
      <div class="section-card">
        <div class="section-header">
          <h3><i class="fas fa-user-friends"></i> Friends ({{ friends|length }})</h3>
          <span class="section-badge">{{ stats.friends_count }} Total</span>
        </div>
        <div class="section-content">
          {% if friends|length > 0 %}
            <div class="friends-list">
              {% for friend in friends %}
                <div class="friend-item">
                  <div class="friend-avatar">{{ friend.name|first|upper }}</div>
                  <div class="friend-info">
                    <div class="friend-name">
                      <a href="/admin/chat/users/{{ friend.uid }}">{{ friend.name }}</a>
                      {% if friend.status %}
                        <span class="friend-status online"><i class="fas fa-circle"></i></span>
                      {% else %}
                        <span class="friend-status offline"><i class="fas fa-ban"></i></span>
                      {% endif %}
                    </div>
                    <div class="friend-meta">
                      <i class="fas fa-calendar"></i> Friends since {{ friend.friend_since|date('M d, Y') }}
                    </div>
                  </div>
                  <div class="friend-actions">
                    <a href="/admin/chat/users/{{ friend.uid }}" class="btn-icon" title="View Profile">
                      <i class="fas fa-eye"></i>
                    </a>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="empty-state">
              <i class="fas fa-user-slash"></i>
              <p>No friends yet</p>
            </div>
          {% endif %}
        </div>
      </div>

      {# Recent Activity #}
      <div class="section-card">
        <div class="section-header">
          <h3><i class="fas fa-history"></i> Recent Activity</h3>
        </div>
        <div class="section-content">
          {% if recent_activity|length > 0 %}
            <div class="activity-timeline">
              {% for activity in recent_activity %}
                <div class="activity-item">
                  <div class="activity-icon {{ activity.type }}">
                    <i class="fas {{ activity.icon }}"></i>
                  </div>
                  <div class="activity-content">
                    <div class="activity-description">{{ activity.description }}</div>
                    <div class="activity-time">
                      <i class="fas fa-clock"></i> {{ activity.timestamp|date('M d, Y H:i') }}
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="empty-state">
              <i class="fas fa-history"></i>
              <p>No recent activity</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    {# Right Column #}
    <div class="content-right">
      {# Pending Requests Sent #}
      <div class="section-card">
        <div class="section-header">
          <h3><i class="fas fa-paper-plane"></i> Requests Sent</h3>
          <span class="section-badge">{{ stats.pending_sent }}</span>
        </div>
        <div class="section-content">
          {% if pending_sent|length > 0 %}
            <div class="requests-list">
              {% for request in pending_sent %}
                <div class="request-item">
                  <div class="request-avatar">{{ request.name|first|upper }}</div>
                  <div class="request-info">
                    <div class="request-name">
                      <a href="/admin/chat/users/{{ request.uid }}">{{ request.name }}</a>
                    </div>
                    <div class="request-meta">
                      <i class="fas fa-clock"></i> {{ request.created|date('M d, Y') }}
                    </div>
                  </div>
                  <div class="request-badge">
                    <span class="badge badge-warning">Pending</span>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="empty-state">
              <i class="fas fa-paper-plane"></i>
              <p>No pending requests sent</p>
            </div>
          {% endif %}
        </div>
      </div>

      {# Pending Requests Received #}
      <div class="section-card">
        <div class="section-header">
          <h3><i class="fas fa-inbox"></i> Requests Received</h3>
          <span class="section-badge">{{ stats.pending_received }}</span>
        </div>
        <div class="section-content">
          {% if pending_received|length > 0 %}
            <div class="requests-list">
              {% for request in pending_received %}
                <div class="request-item">
                  <div class="request-avatar">{{ request.name|first|upper }}</div>
                  <div class="request-info">
                    <div class="request-name">
                      <a href="/admin/chat/users/{{ request.uid }}">{{ request.name }}</a>
                    </div>
                    <div class="request-meta">
                      <i class="fas fa-clock"></i> {{ request.created|date('M d, Y') }}
                    </div>
                  </div>
                  <div class="request-badge">
                    <span class="badge badge-info">Pending</span>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% else %}
            <div class="empty-state">
              <i class="fas fa-inbox"></i>
              <p>No pending requests received</p>
            </div>
          {% endif %}
        </div>
      </div>

      {# Quick Actions #}
      <div class="section-card">
        <div class="section-header">
          <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
        </div>
        <div class="section-content">
          <div class="quick-actions">
            <a href="/user/{{ user_info.uid }}/edit" class="action-btn">
              <i class="fas fa-user-edit"></i>
              <span>Edit Profile</span>
            </a>
            {% if user_info.status %}
              <button class="action-btn danger action-block" data-uid="{{ user_info.uid }}">
                <i class="fas fa-ban"></i>
                <span>Block User</span>
              </button>
            {% else %}
              <button class="action-btn success action-unblock" data-uid="{{ user_info.uid }}">
                <i class="fas fa-check"></i>
                <span>Unblock User</span>
              </button>
            {% endif %}
            <a href="/admin/chat/users" class="action-btn">
              <i class="fas fa-list"></i>
              <span>All Users</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
